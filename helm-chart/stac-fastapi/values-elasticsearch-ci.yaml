# Lightweight values for CI testing with Elasticsearch backend
backend: elasticsearch

app:
  replicaCount: 1
  # SSL Config to match the server
  env:
    ES_USE_SSL: "true"
    ES_VERIFY_CERTS: "false"
  databaseAuth:
    existingSecret: ""
    username: ""
    password: ""

elasticsearch:
  enabled: true
  clusterName: "stac-elasticsearch-ci"
  replicas: 1
  minimumMasterNodes: 1
  
  # Help the chart understand roles
  roles:
    - master
    - data
    - ingest

  # Increased resources for startup reliability
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "2000m"  # Give it burst capacity for startup
      memory: "2Gi"
  
  # Match Heap to Memory Limit (50% rule not strictly needed for CI, but good practice)
  esJavaOpts: "-Xmx1g -Xms1g"

  esConfig:
    elasticsearch.yml: |
      cluster.name: "stac-elasticsearch-ci"
      network.host: 0.0.0.0
      
      # THE CRITICAL FIX:
      discovery.type: single-node
      
      # Security settings (which the chart might override, hence our app env vars above)
      action.destructive_requires_name: false
      xpack.security.enabled: false
      xpack.security.transport.ssl.enabled: false
      xpack.security.http.ssl.enabled: false

  volumeClaimTemplate:
    accessModes: ["ReadWriteOnce"]
    resources:
      requests:
        storage: 5Gi

opensearch:
  enabled: false

externalDatabase:
  enabled: false

monitoring:
  enabled: false
